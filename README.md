# bigDATA project

ะ new_producer.py ะณะตะฝะตัะธัััััั ะดะฐะฝะฝัะต ะฒ ัะตะถะธะผะต ะดะตะผะพะฝะฐ, ะบะพัะพััะต ะธะผะธัะธัััั ัะฐะฑะพัั ะดะฐััะธะบะพะฒ ะฟะพ ะธะทะผะตัะตะฝะธั ัะตะผะฟะตัะฐัััั. ะัะต ะดะฐะฝะฝัะต ะทะฐะฝะพััััั ะฒ kafka, ะฐ ะฟะพัะปะต ะฒ new_consumer.py ััะธััะฒะฐัััั ะดะฐะฝะฝัะต ะธะท kafka ะธ ะทะฐะฟะธััะฒะฐัััั ะฒ ะฑะฐะทั ะดะฐะฝะฝัั (postgres/greenplum) ะฒ ัะปะพะน ััััั ะดะฐะฝะฝัั stg. ะก ะฟะพะผะพััั airflow ัะฐะท ะฒ ะผะธะฝััั ััะธ ะดะฐะฝะฝัะต ััะธััะฒะฐัััั, ัะธะปัััััััั ะทะฐะฟะธัะธ ั ะฟะพะปะพะถะธัะตะปัะฝะพะน ัะตะผะฟะตัะฐัััะพะน ะธ ะทะฐะฟะธััะฒะฐัััั ะฒ ัะปะพะน ะณะพัะพะฒัั ะดะฐะฝะฝัั dds.  

# ะัะบะพะฒะพะดััะฒะพ ะฟะพ ะทะฐะฟััะบั
ะะปั ัะฐะฑะพัั ะฟัะพะตะบัะฐ ะฝัะถะตะฝ ัััะฐะฝะพะฒะปะตะฝะฝัะน docker v20.10.24 ะธ ะฒััะต, docker-compose v2.17.2 ะธ ะฒััะต, DBeaver 23.0.3 ะธ ะฒััะต, Python 3.10 ะธ ะฒััะต.
1. ะกะบะฐัะธะฒะฐะตะผ ะฟัะพะตะบั ั ะณะธัะฐ 
2. ะะฐะปะตะต ะทะฐัะพะดะธะผ ะฒ ะฟะฐะฟะบั airflow ัะตัะตะท ัะตัะผะธะฝะฐะป ะธะปะธ ัะตัะตะท ะฟัะพะฒะพะดะฝะธะบะฐ. ะ ััะพะน ะฟะฐะฟะบะต ะทะฐะฟััะบะฐะตะผ ะบะพะผะฐะฝะดั ```docker-compose up airflow-init``` (ััะฐ ะบะพะผะฐะฝะดะฐ ะฟะพะดะณะพัะพะฒะธั ะพะฑัะทะฐ ะดะปั ะปะพะบะฐะปัะฝะพะณะพ ัะฐะทะฒะตััะฒะพะฒะฐะฝะธั apache airflow).
3. ะะฐะปะตะต ะฒ ััะพะน ะถะต ะฟะฐะฟะบะต ะทะฐะฟััะบะฐะตะผ ะบะพะผะฐะฝะดะฐ ```docker-compose up``` ะดะปั ัะพะณะพ, ััะพะฑั ะฟะพะดะฝััั apache airflow. ะะพ ะฐะดัะตัั http://localhost:8080/ ะพัะบัะพะตัะฐ ะณัะฐัะธัะตัะบะธะน ะธะฝัะตััะตะนั airflow (ะปะพะณะธะฝ - airflow, ะฟะฐัะพะปั - airflow). 
4. ะะฐะฟััะบะฐะผ ะบะพะผะฐะฝะดั ```docker-compose up``` ะฒ ะฟะฐะฟะบะต kafka. ะะพัะปะต ััะฟะตัะฝะพะณะพ ะฟะพะดะฝััะธั ะบะพะฝัะตะนะฝะตัะพะฒ ะทะฐะฟััะบะฐะตะผ ะบะพะผะฐะฝะดั ```docker exec -it kafka /bin/sh```. 
ะะฐะปะตะต ะฒัะฟะพะปะฝัะตะผ ััะด ะบะพะผะฐะฝะด, ััะพะฑั ัะพัะดะฐัั ัะพะฟะธะบ: ```cd /opt/kafka_<version>/bin``` ะณะดะต <version> - ะฒะตััะธั ะบะฐัะบะธ. 
```kafka-topics.sh --create --zookeeper zookeeper:2181 --replication-factor 1 --partitions 1 --topic pr_topic``` - ัะพะทะดะฐะตั ัะพะฟะธะบ ะฒ ะบะฐัะบะต. ะะฐะปะตะต ะฒััะพะดะธะผ ะธะท ะบะพะฝัะตะนะฝะตัะฐ ```exit```.
5. ะะฐะฟััะบะฐะตะผ ```docker-compose up``` ะฒ ะฟะฐะฟะบะต ั ะฑะฐะทะพะน ะดะฐะฝะฝัั postgres. ะ ะฟะพะดะบะปััะฐะตะผัั ะบ ะฑะฐะทะต ะดะฐะฝะฝัั ั ะฟะพะผะพััั DBeaver ะธะปะธ ัะบัะธะฟัะฐ Python ะดะปั ัะพะทะดะฐะฝะธั 2ั ัะฐะฑะปะธั. 
    ```SQL 
    CREATE TABLE public.stg (
	"date" varchar(50) NULL,
	id varchar(20) NULL,
	points varchar(100) NULL,
	temperature varchar(6) NULL,
	hash varchar(50) NULL
    );

    CREATE TABLE public.dds (
	"date" varchar(50) NULL,
	id varchar(20) NULL,
	points varchar(100) NULL,
	temperature varchar(6) NULL,
	hash varchar(50) NULL
    );
    ```

# ะกัััะบัััะฐ ะฟัะพะตะบัะฐ:
    ๐ bigDIG/
    โโ๐ Kafak/
    โ โโ๐ conf.py
    โ โโ๐ docker-compose.yml
    โ โโ๐ new_consumer.py
    โ โโ๐ new_producer.py
    โโ๐ airflow/
    โ โโ๐ dags/
    โ โ โโ๐ project_dag.py
    โ โโ๐ logs/
    โ โโ๐ plugins/
    โ โโ๐ .env
    โ โโ๐ docker-compose.yml
    โโ๐ gp/
    โ โโ๐ docker-compose.yml
    โโ๐ postgres/
    โ โโ๐ docker-compose.yml
    โโ๐ README.md

# ะััะธัะตะบัััะฐ ะฟัะพะตะบัะฐ
![ะกัะตะผะฐ](https://github.com/BlackP8/bigDIG/blob/main/ะฐั.jpg)
