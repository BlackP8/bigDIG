# bigDATA project

–í new_producer.py –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –≤ —Ä–µ–∂–∏–º–µ –¥–µ–º–æ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–∏—Ç–∏—Ä—É—é—Ç —Ä–∞–±–æ—Ç—ã –¥–∞—Ç—á–∏–∫–æ–≤ –ø–æ –∏–∑–º–µ—Ä–µ–Ω–∏—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã. –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–Ω–æ—Å—è—Ç—Å—è –≤ kafka, –∞ –ø–æ—Å–ª–µ –≤ new_consumer.py —Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ kafka –∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (postgres/greenplum) –≤ —Å–ª–æ–π —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö stg. –° –ø–æ–º–æ—â—å—é airflow —Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ —Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è, —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –∑–∞–ø–∏—Å–∏ —Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π –∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Å–ª–æ–π –≥–æ—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö dds.  

# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–ø—É—Å–∫—É
–î–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ –Ω—É–∂–µ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π docker v20.10.24 –∏ –≤—ã—à–µ, docker-compose v2.17.2 –∏ –≤—ã—à–µ, DBeaver 23.0.3 –∏ –≤—ã—à–µ, Python 3.10 –∏ –≤—ã—à–µ.
1. –°–∫–∞—á–∏–≤–∞–µ–º –ø—Ä–æ–µ–∫—Ç —Å –≥–∏—Ç–∞ 
2. –î–∞–ª–µ–µ –∑–∞—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É airflow —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª –∏–ª–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–∞. –í —ç—Ç–æ–π –ø–∞–ø–∫–µ –∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–º–∞–Ω–¥—É ```docker-compose up airflow-init``` (—ç—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç –æ–±—Ä–∑–∞ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è apache airflow).
3. –î–∞–ª–µ–µ –≤ —ç—Ç–æ–π –∂–µ –ø–∞–ø–∫–µ –∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–º–∞–Ω–¥–∞ ```docker-compose up``` –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–¥–Ω—è—Ç—å apache airflow. –ü–æ –∞–¥—Ä–µ—Å—É http://localhost:8080/ –æ—Ç–∫—Ä–æ–µ—Ç–∞ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å airflow (–ª–æ–≥–∏–Ω - airflow, –ø–∞—Ä–æ–ª—å - airflow). 
4. –ó–∞–ø—É—Å–∫–∞–º –∫–æ–º–∞–Ω–¥—É ```docker-compose up``` –≤ –ø–∞–ø–∫–µ kafak. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–¥–Ω—è—Ç–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–º–∞–Ω–¥—É ```docker exec -it kafka /bin/sh```. 
–î–∞–ª–µ–µ –≤—ã–ø–æ–ª–Ω—è–µ–º —Ä—è–¥ –∫–æ–º–∞–Ω–¥, —á—Ç–æ–±—ã —Å–æ—Å–¥–∞—Ç—å —Ç–æ–ø–∏–∫: ```cd /opt/kafka_<version>/bin``` –≥–¥–µ <version> - –≤–µ—Ä—Å–∏—è –∫–∞—Ñ–∫–∏. 
```kafka-topics.sh --create --zookeeper zookeeper:2181 --replication-factor 1 --partitions 1 --topic pr_topic``` - —Å–æ–∑–¥–∞–µ—Ç —Ç–æ–ø–∏–∫ –≤ –∫–∞—Ñ–∫–µ. –î–∞–ª–µ–µ –≤—ã—Ö–æ–¥–∏–º –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ ```exit```.
5. –ó–∞–ø—É—Å–∫–∞–µ–º ```docker-compose up``` –≤ –ø–∞–ø–∫–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö postgres. –ò –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é DBeaver –∏–ª–∏ —Å–∫—Ä–∏–ø—Ç–∞ Python –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è 2—Ö —Ç–∞–±–ª–∏—Ü. 
    ```SQL 
    CREATE TABLE public.stg (
	"date" varchar(50) NULL,
	id varchar(20) NULL,
	points varchar(100) NULL,
	temperature varchar(6) NULL,
	hash varchar(50) NULL
    );

    CREATE TABLE public.dds (
	"date" varchar(50) NULL,
	id varchar(20) NULL,
	points varchar(100) NULL,
	temperature varchar(6) NULL,
	hash varchar(50) NULL
    );
    ```
6. –î–∞–ª–µ–µ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å ```docker network connect airflow_default dbforairflow``` –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å container —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –≤ —Å–µ—Ç—å –∫ airflow. (—Ç–∞–∫–∂–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –∫–∞–∫–æ–π ip –∞–¥—Ä–µ—Å –ø–æ–ø–∞–ª –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö dbforairflow –≤ —Å–µ—Ç–∏ airflow_default —Å –ø–æ–º–æ—â—å—é ```docker network inspect airflow_default```–∏ –ø–æ–º–µ–Ω—è—Ç—å –µ–≥–æ –≤ connections –≤ GUI airflow).
7. –¢–µ–ø–µ—Ä—å —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–∞–π–ª—ã new_consumer.py –∏ new_producer.py c –ø–æ—â—å—é –∫–æ–º–∞–Ω–¥ ```python new_consumer.py``` –∏ ```python new_producer.py```, –∫–æ—Ç–æ—Ä—ã–µ –ª–µ–∂–∞—Ç –≤ –ø–∞–ø–∫–µ kafak. 

# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:
    üìÅ bigDIG/
    ‚îú‚îÄüìÅ Kafak/
    ‚îÇ ‚îú‚îÄüìÑ conf.py
    ‚îÇ ‚îú‚îÄüìÑ docker-compose.yml
    ‚îÇ ‚îú‚îÄüìÑ new_consumer.py
    ‚îÇ ‚îî‚îÄüìÑ new_producer.py
    ‚îú‚îÄüìÅ airflow/
    ‚îÇ ‚îú‚îÄüìÅ dags/
    ‚îÇ ‚îÇ ‚îî‚îÄüìÑ project_dag.py
    ‚îÇ ‚îú‚îÄüìÅ logs/
    ‚îÇ ‚îú‚îÄüìÅ plugins/
    ‚îÇ ‚îú‚îÄüìÑ .env
    ‚îÇ ‚îî‚îÄüìÑ docker-compose.yml
    ‚îú‚îÄüìÅ gp/
    ‚îÇ ‚îî‚îÄüìÑ docker-compose.yml
    ‚îú‚îÄüìÅ postgres/
    ‚îÇ ‚îî‚îÄüìÑ docker-compose.yml
    ‚îî‚îÄüìÑ README.md

# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
![–°—Ö–µ–º–∞](https://github.com/BlackP8/bigDIG/blob/main/–∞—Ä.jpg)
